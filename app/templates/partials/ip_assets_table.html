<section class="card table-card">
  <form class="bulk-edit-form" method="post" action="/ui/ip-assets/bulk-edit" data-bulk-form>
    <input type="hidden" name="return_to" value="{{ return_to }}">
    <div class="bulk-edit-controls bulk-edit-controls-hidden" data-bulk-controls>
      <div class="bulk-edit-selection">
        <label class="field field-inline">
          <input type="checkbox" class="checkbox" data-bulk-select-all aria-label="Select all IP assets">
          <span>Select all</span>
        </label>
        <span class="muted" data-selected-count>0 selected</span>
      </div>
      <div class="bulk-edit-fields">
        <label class="field field-inline">
          <span class="muted">Type</span>
          <select class="select" name="type">
            <option value="">Keep current</option>
            {% for asset_type in types %}
            <option value="{{ asset_type }}">{{ asset_type }}</option>
            {% endfor %}
          </select>
        </label>
        <label class="field field-inline">
          <span class="muted">Project</span>
          <select class="select" name="project_id">
            <option value="">Keep current</option>
            <option value="unassigned">Unassigned</option>
            {% for project in projects %}
            <option value="{{ project.id }}">{{ project.name }}</option>
            {% endfor %}
          </select>
        </label>
        <label class="field field-inline">
          <span class="muted">Add tags</span>
          <select class="select" name="tags" multiple size="4" data-tag-picker data-tag-picker-placeholder="Add tags...">
            {% for tag in tags %}
            <option value="{{ tag.name }}" data-tag-color="{{ tag.color }}">{{ tag.name }}</option>
            {% endfor %}
          </select>
        </label>
        <button class="btn btn-primary btn-small" type="submit" data-bulk-submit disabled>Apply changes</button>
      </div>
    </div>
    <div class="table-wrapper">
      <table class="table table-ip-assets">
        <thead>
          <tr>
            <th>
              <span class="visually-hidden">Select</span>
            </th>
            <th class="col-ip-address">IP address</th>
            <th class="col-project">Project</th>
            <th class="col-type">Type</th>
            <th>Tags</th>
            <th>Notes</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="ip-table-body">
          {% include "partials/ip_table_rows.html" %}
        </tbody>
      </table>
    </div>
  </form>
  <div class="table-footer">
    <div class="table-meta">
      {% if pagination.total %}
      Showing {{ pagination.start_index }}-{{ pagination.end_index }} of {{ pagination.total }}
      {% else %}
      No results to display.
      {% endif %}
    </div>
    <div class="table-footer-controls">
      <div class="table-per-page">
        <form method="get" action="/ui/ip-assets" class="per-page-form" hx-get="/ui/ip-assets" hx-trigger="submit" hx-target="#ip-table-container" hx-push-url="true">
          <label class="field field-inline">
            <span>Rows</span>
            <select
              class="select select-minimal"
              name="per-page"
              hx-get="/ui/ip-assets"
              hx-trigger="change"
              hx-target="#ip-table-container"
              hx-push-url="true"
              hx-include="closest form"
            >
              {% for option in [10, 20, 50, 100] %}
              <option value="{{ option }}"{% if pagination.per_page == option %} selected{% endif %}>{{ option }}</option>
              {% endfor %}
            </select>
          </label>
        </form>
      </div>
      {% if pagination.total_pages > 1 %}
      <nav class="pagination" aria-label="IP assets pagination">
        <a
          class="btn btn-secondary btn-small{% if not pagination.has_prev %} btn-disabled{% endif %}"
          href="/ui/ip-assets?{{ pagination.base_query }}&page={{ pagination.page - 1 }}"
          {% if pagination.has_prev %}
          hx-get="/ui/ip-assets?{{ pagination.base_query }}&page={{ pagination.page - 1 }}"
          hx-target="#ip-table-container"
          hx-push-url="true"
          {% else %}
          aria-disabled="true"
          tabindex="-1"
          {% endif %}
        >
          Previous
        </a>
        <span class="pagination-status">Page {{ pagination.page }} of {{ pagination.total_pages }}</span>
        <a
          class="btn btn-secondary btn-small{% if not pagination.has_next %} btn-disabled{% endif %}"
          href="/ui/ip-assets?{{ pagination.base_query }}&page={{ pagination.page + 1 }}"
          {% if pagination.has_next %}
          hx-get="/ui/ip-assets?{{ pagination.base_query }}&page={{ pagination.page + 1 }}"
          hx-target="#ip-table-container"
          hx-push-url="true"
          {% else %}
          aria-disabled="true"
          tabindex="-1"
          {% endif %}
        >
          Next
        </a>
      </nav>
      {% endif %}
    </div>
  </div>
</section>
<style>
  .table-footer-controls {
    display: flex;
    align-items: center;
    gap: 16px;
  }
  .table-per-page {
    display: flex;
    align-items: center;
  }
  .per-page-form {
    margin: 0;
  }
  .per-page-form .field {
    margin: 0;
    flex-direction: row;
    align-items: center;
    gap: 6px;
  }
  .per-page-form .field span {
    font-size: 12px;
    color: var(--color-muted-light, #64748b);
    font-weight: 400;
  }
  .select-minimal {
    appearance: none;
    background: transparent;
    border: 1px solid #e2e8f0;
    border-radius: 4px;
    padding: 2px 20px 2px 6px;
    font-size: 12px;
    color: #64748b;
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 4px center;
  }
  .select-minimal:hover {
    border-color: #cbd5e1;
  }
  .select-minimal:focus {
    outline: none;
    border-color: #94a3b8;
  }
</style>
