{% if assets %}
{% for asset in assets %}
<tr data-ip-asset-row-id="{{ asset.id }}">
  <td>
    <input
      class="checkbox"
      type="checkbox"
      name="asset_ids"
      value="{{ asset.id }}"
      data-bulk-select
      data-bulk-tags="{{ asset.tags | map(attribute='name') | join(',') }}"
    >
  </td>
  <td class="mono col-ip-address"><a href="/ui/ip-assets/{{ asset.id }}">{{ asset.ip_address }}</a></td>
  <td class="col-project">
    {% if asset.project_unassigned %}
    <span class="tag tag-warning">Unassigned</span>
    {% else %}
    <button
      class="tag tag-project tag-filter-chip"
      type="button"
      data-quick-filter="project_id"
      data-quick-filter-value="{{ asset.project_id }}"
      style="--project-color: {{ asset.project_color or '#94a3b8' }}"
    >
      {{ asset.project_name }}
    </button>
    {% endif %}
  </td>
  <td class="col-type">
    <button
      class="tag tag-color tag-filter-chip"
      type="button"
      data-quick-filter="type"
      data-quick-filter-value="{{ asset.type }}"
    >
      {{ asset.type }}
    </button>
  </td>
  <td class="ip-tags-cell">
    {% if asset.tags %}
    <div class="ip-tags-inline" aria-label="Tags for {{ asset.ip_address }}">
      {% set visible_tags = asset.tags[:2] if asset.tags|length > 3 else asset.tags %}
      {% for tag in visible_tags %}
      <button
        class="tag tag-color tag-filter-chip"
        type="button"
        data-quick-filter="tag"
        data-quick-filter-value="{{ tag.name }}"
        style="--tag-color: {{ tag.color }}"
      >{{ tag.name }}</button>
      {% endfor %}
      {% if asset.tags|length > 3 %}
      <button
        class="tag tag-muted ip-tags-more"
        type="button"
        data-tags-more-toggle
        data-tags-ip="{{ asset.ip_address }}"
        data-tags-json='{{ asset.tags | tojson | e }}'
        aria-haspopup="dialog"
        aria-expanded="false"
      >+{{ asset.tags|length - 2 }} more</button>
      {% endif %}
    </div>
    {% else %}
    <span class="muted">—</span>
    {% endif %}
  </td>
  <td class="ip-note-cell">
    {% if asset.notes %}
    <span
      class="ip-note-preview muted"
      tabindex="0"
      title="{{ asset.notes }}"
      data-full-note="{{ asset.notes | e }}"
    >{{ asset.notes }}</span>
    {% else %}
    <span class="muted">—</span>
    {% endif %}
  </td>
  <td class="asset-actions-cell">
    <div class="ip-asset-actions">
      <button
        class="btn btn-secondary btn-small"
        type="button"
        data-ip-edit="{{ asset.id }}"
        data-ip-address="{{ asset.ip_address }}"
        data-ip-type="{{ asset.type }}"
        data-ip-project-id="{{ asset.project_id }}"
        data-ip-project-name="{{ asset.project_name }}"
        data-ip-host-id="{{ asset.host_id }}"
        data-ip-host-name="{{ asset.host_name }}"
        data-ip-notes="{{ asset.notes }}"
        data-ip-tags="{{ asset.tags_value }}"
      >
        Edit
      </button>
      <button
        class="btn btn-danger btn-small"
        type="button"
        data-ip-delete="{{ asset.id }}"
        data-ip-address="{{ asset.ip_address }}"
        data-ip-type="{{ asset.type }}"
        data-ip-project-id="{{ asset.project_id }}"
        data-ip-project-name="{{ asset.project_name or 'Unassigned' }}"
        data-ip-host-id="{{ asset.host_id }}"
        data-ip-host-name="{{ asset.host_name or '—' }}"
        data-ip-tags="{{ asset.tags_value }}"
      >
        Delete
      </button>
    </div>
  </td>
</tr>
{% endfor %}
{% else %}
<tr>
  <td colspan="7" class="empty-state">No IP assets found.</td>
</tr>
{% endif %}
